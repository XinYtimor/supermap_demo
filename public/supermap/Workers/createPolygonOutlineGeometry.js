define(["./when-b60132fc","./Cartesian2-47311507","./ArcType-29cf2197","./arrayFill-4513d7ad","./buildModuleUrl-57a32107","./Check-7b2a090c","./ComponentDatatype-c140a87d","./EllipsoidTangentPlane-ceab6aaa","./GeometryAttribute-c42d25b7","./GeometryAttributes-252e9929","./GeometryInstance-dbc9f4c4","./GeometryOffsetAttribute-fbeb6f1a","./GeometryPipeline-6d9322f0","./IndexDatatype-8a5eead4","./Math-119be1a3","./PolygonGeometryLibrary-20c09e27","./PolygonPipeline-805ba13c","./Cartographic-3309dd0d","./Matrix4-cde86d0e","./Cartesian4-3ca25aab","./RuntimeError-4a5c8994","./WebGLConstants-4ae0db90","./IntersectionTests-5e35c2ab","./Plane-ca0357f4","./FeatureDetection-c3b71206","./AttributeCompression-90851096","./EncodedCartesian3-f1396b05","./arrayRemoveDuplicates-d2f048c5","./EllipsoidRhumbLine-ed1a6bf4","./earcut-2.2.1-20c8012f"],(function(e,t,i,r,o,n,a,l,s,y,u,p,d,c,g,f,h,m,b,P,v,E,A,_,G,L,H,T,C,O){"use strict";var D=[],x=[];function I(e,t,r,n,p){var d,g,m=l.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,D);h.PolygonPipeline.computeWindingOrder2D(m)===h.WindingOrder.CLOCKWISE&&(m.reverse(),t=t.slice().reverse());var b=t.length,P=0;if(n)for(d=new Float64Array(2*b*3),g=0;g<b;g++){var v=t[g],E=t[(g+1)%b];d[P++]=v.x,d[P++]=v.y,d[P++]=v.z,d[P++]=E.x,d[P++]=E.y,d[P++]=E.z}else{var A=0;if(p===i.ArcType.GEODESIC)for(g=0;g<b;g++)A+=f.PolygonGeometryLibrary.subdivideLineCount(t[g],t[(g+1)%b],r);else if(p===i.ArcType.RHUMB)for(g=0;g<b;g++)A+=f.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[g],t[(g+1)%b],r);for(d=new Float64Array(3*A),g=0;g<b;g++){var _;p===i.ArcType.GEODESIC?_=f.PolygonGeometryLibrary.subdivideLine(t[g],t[(g+1)%b],r,x):p===i.ArcType.RHUMB&&(_=f.PolygonGeometryLibrary.subdivideRhumbLine(e,t[g],t[(g+1)%b],r,x));for(var G=_.length,L=0;L<G;++L)d[P++]=_[L]}}var H=2*(b=d.length/3),T=c.IndexDatatype.createTypedArray(b,H);for(P=0,g=0;g<b-1;g++)T[P++]=g,T[P++]=g+1;return T[P++]=b-1,T[P++]=0,new u.GeometryInstance({geometry:new s.Geometry({attributes:new y.GeometryAttributes({position:new s.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:d})}),indices:T,primitiveType:o.PrimitiveType.LINES})})}function w(e,t,r,n,p){var d,g,m=l.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,D);h.PolygonPipeline.computeWindingOrder2D(m)===h.WindingOrder.CLOCKWISE&&(m.reverse(),t=t.slice().reverse());var b=t.length,P=new Array(b),v=0;if(n)for(d=new Float64Array(2*b*3*2),g=0;g<b;++g){P[g]=v/3;var E=t[g],A=t[(g+1)%b];d[v++]=E.x,d[v++]=E.y,d[v++]=E.z,d[v++]=A.x,d[v++]=A.y,d[v++]=A.z}else{var _=0;if(p===i.ArcType.GEODESIC)for(g=0;g<b;g++)_+=f.PolygonGeometryLibrary.subdivideLineCount(t[g],t[(g+1)%b],r);else if(p===i.ArcType.RHUMB)for(g=0;g<b;g++)_+=f.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[g],t[(g+1)%b],r);for(d=new Float64Array(3*_*2),g=0;g<b;++g){var G;P[g]=v/3,p===i.ArcType.GEODESIC?G=f.PolygonGeometryLibrary.subdivideLine(t[g],t[(g+1)%b],r,x):p===i.ArcType.RHUMB&&(G=f.PolygonGeometryLibrary.subdivideRhumbLine(e,t[g],t[(g+1)%b],r,x));for(var L=G.length,H=0;H<L;++H)d[v++]=G[H]}}b=d.length/6;var T=P.length,C=2*(2*b+T),O=c.IndexDatatype.createTypedArray(b,C);for(v=0,g=0;g<b;++g)O[v++]=g,O[v++]=(g+1)%b,O[v++]=g+b,O[v++]=(g+1)%b+b;for(g=0;g<T;g++){var I=P[g];O[v++]=I,O[v++]=I+b}return new u.GeometryInstance({geometry:new s.Geometry({attributes:new y.GeometryAttributes({position:new s.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:d})}),indices:O,primitiveType:o.PrimitiveType.LINES})})}function S(r){var o=r.polygonHierarchy,n=e.defaultValue(r.ellipsoid,t.Ellipsoid.WGS84),a=e.defaultValue(r.granularity,g.CesiumMath.RADIANS_PER_DEGREE),l=e.defaultValue(r.perPositionHeight,!1),s=l&&e.defined(r.extrudedHeight),y=e.defaultValue(r.arcType,i.ArcType.GEODESIC),u=e.defaultValue(r.height,0),p=e.defaultValue(r.extrudedHeight,u);if(!s){var d=Math.max(u,p);p=Math.min(u,p),u=d}this._ellipsoid=t.Ellipsoid.clone(n),this._granularity=a,this._height=u,this._extrudedHeight=p,this._arcType=y,this._polygonHierarchy=o,this._perPositionHeight=l,this._perPositionHeightExtrude=s,this._offsetAttribute=r.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=f.PolygonGeometryLibrary.computeHierarchyPackedLength(o)+t.Ellipsoid.packedLength+8}S.pack=function(i,r,o){return o=e.defaultValue(o,0),o=f.PolygonGeometryLibrary.packPolygonHierarchy(i._polygonHierarchy,r,o),t.Ellipsoid.pack(i._ellipsoid,r,o),o+=t.Ellipsoid.packedLength,r[o++]=i._height,r[o++]=i._extrudedHeight,r[o++]=i._granularity,r[o++]=i._perPositionHeightExtrude?1:0,r[o++]=i._perPositionHeight?1:0,r[o++]=i._arcType,r[o++]=e.defaultValue(i._offsetAttribute,-1),r[o]=i.packedLength,r};var k=t.Ellipsoid.clone(t.Ellipsoid.UNIT_SPHERE),R={polygonHierarchy:{}};return S.unpack=function(i,r,o){r=e.defaultValue(r,0);var n=f.PolygonGeometryLibrary.unpackPolygonHierarchy(i,r);r=n.startingIndex,delete n.startingIndex;var a=t.Ellipsoid.unpack(i,r,k);r+=t.Ellipsoid.packedLength;var l=i[r++],s=i[r++],y=i[r++],u=1===i[r++],p=1===i[r++],d=i[r++],c=i[r++],g=i[r];return e.defined(o)||(o=new S(R)),o._polygonHierarchy=n,o._ellipsoid=t.Ellipsoid.clone(a,o._ellipsoid),o._height=l,o._extrudedHeight=s,o._granularity=y,o._perPositionHeight=p,o._perPositionHeightExtrude=u,o._arcType=d,o._offsetAttribute=-1===c?void 0:c,o.packedLength=g,o},S.fromPositions=function(t){return new S({polygonHierarchy:{positions:(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).positions},height:t.height,extrudedHeight:t.extrudedHeight,ellipsoid:t.ellipsoid,granularity:t.granularity,perPositionHeight:t.perPositionHeight,arcType:t.arcType,offsetAttribute:t.offsetAttribute})},S.createGeometry=function(t){var i=t._ellipsoid,n=t._granularity,l=t._polygonHierarchy,y=t._perPositionHeight,u=t._arcType,c=f.PolygonGeometryLibrary.polygonOutlinesFromHierarchy(l,!y,i);if(0!==c.length){var m,b,P,v=[],E=g.CesiumMath.chordLength(n,i.maximumRadius),A=t._height,_=t._extrudedHeight;if(t._perPositionHeightExtrude||!g.CesiumMath.equalsEpsilon(A,_,0,g.CesiumMath.EPSILON2))for(P=0;P<c.length;P++){if((m=w(i,c[P],E,y,u)).geometry=f.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(m.geometry,A,_,i,y),e.defined(t._offsetAttribute)){var G=m.geometry.attributes.position.values.length/3,L=new Uint8Array(G);t._offsetAttribute===p.GeometryOffsetAttribute.TOP?L=r.arrayFill(L,1,0,G/2):(b=t._offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1,L=r.arrayFill(L,b)),m.geometry.attributes.applyOffset=new s.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}v.push(m)}else for(P=0;P<c.length;P++){if((m=I(i,c[P],E,y,u)).geometry.attributes.position.values=h.PolygonPipeline.scaleToGeodeticHeight(m.geometry.attributes.position.values,A,i,!y),e.defined(t._offsetAttribute)){var H=m.geometry.attributes.position.values.length,T=new Uint8Array(H/3);b=t._offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1,r.arrayFill(T,b),m.geometry.attributes.applyOffset=new s.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:T})}v.push(m)}var C=d.GeometryPipeline.combineInstances(v)[0],O=o.BoundingSphere.fromVertices(C.attributes.position.values);return new s.Geometry({attributes:C.attributes,indices:C.indices,primitiveType:C.primitiveType,boundingSphere:O,offsetAttribute:t._offsetAttribute})}},function(i,r){return e.defined(r)&&(i=S.unpack(i,r)),i._ellipsoid=t.Ellipsoid.clone(i._ellipsoid),S.createGeometry(i)}}));
